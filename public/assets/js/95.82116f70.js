(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{558:function(e,t,n){"use strict";n.r(t);var a=n(1),r=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"context是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#context是什么"}},[e._v("#")]),e._v(" Context是什么")]),e._v(" "),t("p",[e._v("context是Golang1.7才引入的，它表示的是goroutine的上下文，包含着goroutine的运行状态、环境、现场等信息。主要用来：取消信号、超时时间、截止日期、传递请求相关值等。")]),e._v(" "),t("h2",{attrs:{id:"接口与实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接口与实现"}},[e._v("#")]),e._v(" 接口与实现")]),e._v(" "),t("p",[e._v("context接口定义了四个需要实现的方法")]),e._v(" "),t("ol",[t("li",[t("p",[t("strong",[e._v("Deadline() (deadline time.Time, ok bool)")]),e._v("—返回context取消的时间，也就是完成工作的截止日期。")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("Done() <-chan struct{}")]),e._v("—返回一个channel，这个channel会在当前工作完成或者上下文被取消后关闭，多个调用返回的都为同一个channel")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("Err() error")]),e._v("—返回context结束的原因，它只会在Done方法对应的Channel关闭时返回非空的值。")]),e._v(" "),t("p",[e._v("a) 如果context被取消，会返回"),t("code",[e._v("Canceled")]),e._v("错误。")]),e._v(" "),t("p",[e._v("b) 如果context超时，会返回"),t("code",[e._v("DeadlineExceeded")]),e._v("错误。")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("Value(key any) any")]),e._v("—从 "),t("code",[e._v("context")]),e._v("中获取键对应的值，对于同一个上下文来说，多次调用 "),t("code",[e._v("Value")]),e._v(" 并传入相同的 "),t("code",[e._v("Key")]),e._v(" 会返回相同的结果，该方法可以用来传递请求特定的数据；")])])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("type Context interface {\n\tDeadline() (deadline time.Time, ok bool)\n\tDone() <-chan struct{}\n\tErr() error\n\tValue(key interface{}) interface{}\n}\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("p",[e._v("context的常用方法")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://draveness.me/golang/tree/context.Background",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("context.Background")]),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"https://draveness.me/golang/tree/context.TODO",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("context.TODO")]),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"https://draveness.me/golang/tree/context.WithDeadline",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("context.WithDeadline")]),t("OutboundLink")],1)]),e._v(" "),t("p",[t("a",{attrs:{href:"https://draveness.me/golang/tree/context.WithValue",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("context.WithValue")]),t("OutboundLink")],1)]),e._v(" "),t("h2",{attrs:{id:"设计原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设计原理"}},[e._v("#")]),e._v(" 设计原理")]),e._v(" "),t("h2",{attrs:{id:"默认上下文"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#默认上下文"}},[e._v("#")]),e._v(" 默认上下文")]),e._v(" "),t("p",[e._v("context中最常用的还是"),t("code",[e._v("context.Background")]),e._v("、"),t("code",[e._v("context.Todo")]),e._v("，这两个方法都会返回")]),e._v(" "),t("h2",{attrs:{id:"取消信号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#取消信号"}},[e._v("#")]),e._v(" 取消信号")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://draveness.me/golang/tree/context.WithCancel",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("context.WithCancel")]),t("OutboundLink")],1)]),e._v(" "),t("h2",{attrs:{id:"传递请求相关值"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#传递请求相关值"}},[e._v("#")]),e._v(" 传递请求相关值")]),e._v(" "),t("p",[e._v("context.Withvalue")])])}),[],!1,null,null,null);t.default=r.exports}}]);