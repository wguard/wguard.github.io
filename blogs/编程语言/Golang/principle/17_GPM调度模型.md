---
title: 17-GPM调度模型
date: 2023-06-04
sidebar: 'auto'
categories:
 - Golang
tags:
 - Golang实现原理
---

> 本文的Go源码基于go1.19

# GPM调度模型

## 进程与线程

在理解GPM调度模型时，我们要先弄清楚进程与线程的概念。在多数操作系统当中，线程属于进程。典型的UNIX进程可以看做只有一个控制线程：一个进程在某一时刻只能干一件事情。

## 设计原理

如今的Go语言的调度器有着优异的性能，但是发展非常艰辛。调度器经过几个大版本的迭代才有今天的优异性能，历史上几个不同版本的调度器引入了不同的改进，也存在着不同的缺陷。

### 单线程调度器

GM模型

### 多线程调度器

### 任务窃取调度器

### 抢占式调度器

### 非均匀存储访问调度器

## 数据结构

### G

G表示**Goroutine**，只存在于Go语言运行时，表示一个待执行的任务。它是Go在用户态提供的线程，占用了更小的内存空间，也大大降低了上下文的切换。

```go

```

### M

M表示**操作系统的线程**，它由操作系统的调度器调度和管理。

### P

P表示**处理器**，它被用来在M上调度G。

## 调度器启动

### 执行过程

虚拟地址空间

程序入口：go语言的程序入口不是main.main，在不同平台下go的执行入口不同。经过一系列的检查和初始化等准备工作后，会创建main goroutine，执行成功后才调用main.main。

